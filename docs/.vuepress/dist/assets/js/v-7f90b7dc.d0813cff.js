"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8350],{1376:(s,n,a)=>{a.r(n),a.d(n,{data:()=>e});const e={key:"v-7f90b7dc",path:"/dev/ionic/deploy.html",title:"Déploiment d'un application Ionic avec capacitor",lang:"fr-FR",frontmatter:{},excerpt:"",headers:[{level:2,title:"keytool",slug:"keytool",children:[]},{level:2,title:"Passer en production",slug:"passer-en-production",children:[]},{level:2,title:"Les erreurs",slug:"les-erreurs",children:[]}],filePathRelative:"dev/ionic/deploy.md",git:{updatedTime:1633995064e3,contributors:[{name:"kratos",email:"desmond8500@gmail.com",commits:1}]}}},9145:(s,n,a)=>{a.r(n),a.d(n,{default:()=>c});var e=a(6252);const r=(0,e.uE)('<h1 id="deploiment-d-un-application-ionic-avec-capacitor" tabindex="-1"><a class="header-anchor" href="#deploiment-d-un-application-ionic-avec-capacitor" aria-hidden="true">#</a> Déploiment d&#39;un application Ionic avec capacitor</h1><h2 id="keytool" tabindex="-1"><a class="header-anchor" href="#keytool" aria-hidden="true">#</a> keytool</h2><p>A installer au besoin, télécharger jdk et l&#39;ajouter au variables d&#39;environnement de windows <code>C:\\Program Files\\Java\\jdk1.8.0_181\\bin</code></p><p>Ensuite il faut générer le fichier <code>release.jks</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>keytool -genkey -v -keystore release.jks -keyalg RSA -keysize <span class="token number">2048</span> -validity <span class="token number">1000</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="passer-en-production" tabindex="-1"><a class="header-anchor" href="#passer-en-production" aria-hidden="true">#</a> Passer en production</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ionic capacitor build android\nnpx cap <span class="token function">sync</span> android\nnpx cap <span class="token function">open</span> android\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Dans le terminal aller dans le dossier android :</p><div class="language-dh ext-dh line-numbers-mode"><pre class="language-dh"><code>cd android\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>créer à la racine du projet un fichier <code>keystore.properties</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">storePassword</span><span class="token operator">=</span>Passer1234<span class="token operator">!</span>\n<span class="token assign-left variable">keyPassword</span><span class="token operator">=</span>Passer1234<span class="token operator">!</span>\n<span class="token assign-left variable">keyAlias</span><span class="token operator">=</span>release\n<span class="token assign-left variable">storeFile</span><span class="token operator">=</span>./<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/release.jks\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Configurer la génération automatique de bundle signé dans le fichier <code>android&gt;app&gt;build.gradle</code> et ajouter juste après <code>apply plugin</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>def keystorePropertiesFile <span class="token operator">=</span> rootProject<span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token string">&quot;../keystore.properties&quot;</span><span class="token punctuation">)</span>\ndef keystoreProperties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\nkeystoreProperties<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>keystorePropertiesFile<span class="token punctuation">)</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>puis avant <code>buildTypes</code> :</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>signingConfigs<span class="token punctuation">{</span>\n    release<span class="token punctuation">{</span>\n        keyAlias keystoreProperties<span class="token punctuation">[</span><span class="token string">&#39;keyAlias&#39;</span><span class="token punctuation">]</span>\n        keyPassword keystoreProperties<span class="token punctuation">[</span><span class="token string">&#39;keyPassword&#39;</span><span class="token punctuation">]</span>\n        storeFile <span class="token function">file</span><span class="token punctuation">(</span>keystoreProperties<span class="token punctuation">[</span><span class="token string">&#39;storeFile&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n        storePassword keystoreProperties<span class="token punctuation">[</span><span class="token string">&#39;storePassword&#39;</span><span class="token punctuation">]</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>dans <code>buildTypes</code> ajouter :</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>buildTypes <span class="token punctuation">{</span>\n    release <span class="token punctuation">{</span>\n        signingConfig signingConfigs.release\n        minifyEnabled <span class="token boolean">false</span>\n        proguardFiles getDefaultProguardFile<span class="token punctuation">(</span><span class="token string">&#39;proguard-android.txt&#39;</span><span class="token punctuation">)</span>, <span class="token string">&#39;proguard-rules.pro&#39;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>Installer gradle</strong></p><p>En cas d&#39;erreurs vérifier le fichier <code>android &gt; gradle &gt; wrapper</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>./gradlew task\n./gradlew bundle\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>./gradlew bundleRelease\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><strong>Signer le bundle</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>jarsigner -sigalg SHA256withRSA -digestalg SHA-256 -kesytore release.jks\n./android/app/build/outputs/bundle/release/app-release.aab\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><hr><h2 id="les-erreurs" tabindex="-1"><a class="header-anchor" href="#les-erreurs" aria-hidden="true">#</a> Les erreurs</h2>',25),l={href:"https://stackoverflow.com/questions/32513740/gradle-build-failure-could-not-open-proj-class-cache-for-build-file",target:"_blank",rel:"noopener noreferrer"},p=(0,e.Uk)("Could not open proj generic class cache for build file"),o=(0,e.Wm)("br",null,null,-1),i=(0,e.Uk)(" Il faudra supprimer le dossier "),t=(0,e.Wm)("code",null,"/Users/<username>/.gradle/caches",-1),c={render:function(s,n){const a=(0,e.up)("OutboundLink");return(0,e.wg)(),(0,e.j4)(e.HY,null,[r,(0,e.Wm)("ul",null,[(0,e.Wm)("li",null,[(0,e.Wm)("a",l,[p,(0,e.Wm)(a)]),o,i,t])])],64)}}}}]);